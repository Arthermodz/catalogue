<script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.min.js"></script>

<script>
pdfjsLib.GlobalWorkerOptions.workerSrc =
  "https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.worker.min.js";

const url = "catalogue.pdf";

const container = document.getElementById("pdf-container");
const searchInput = document.getElementById("searchInput");
const categoryList = document.getElementById("category-list");

let pdfDoc = null;
let currentPage = 1;

/* ===== LOAD PDF ===== */
pdfjsLib.getDocument(url).promise.then((pdf) => {
  pdfDoc = pdf;
  renderPage(1);
});

/* ===== RENDER PAGE ===== */
function renderPage(pageNum) {
  if (!pdfDoc || pageNum < 1 || pageNum > pdfDoc.numPages) return;

  currentPage = pageNum;
  container.innerHTML = "";

  pdfDoc.getPage(pageNum).then((page) => {
    const viewport = page.getViewport({ scale: getScale() });
    const canvas = document.createElement("canvas");
    const ctx = canvas.getContext("2d");

    canvas.width = viewport.width;
    canvas.height = viewport.height;

    container.appendChild(canvas);

    page.render({
      canvasContext: ctx,
      viewport: viewport,
    });
  });
}

/* ===== RESPONSIVE SCALE ===== */
function getScale() {
  return window.innerWidth < 768 ? 1.1 : 1.4;
}

window.addEventListener("resize", () => {
  renderPage(currentPage);
});

/* ===== SEARCH ===== */
searchInput.addEventListener("keydown", (e) => {
  if (e.key === "Enter") {
    const page = parseInt(searchInput.value);
    if (!isNaN(page)) renderPage(page);
  }
});

/* ===== CATEGORIES ===== */
const categories = [
   "WINNER": 3,
  "ELBAHDJA": 5,
  "FENNEC": 7,
  "FIORI": 9,
  "LINE": 11,
  "RIO": 13,
  "AZUR": 15,
  "AURORE": 17,
  "ECLIPSE": 19,
  "GHOUL": 5,

  "MITIGEUR CUISINE": 23,
  "COLONNE DE DOUCHE": 27,

  "ROBINET LAVABO": 37,
  "ROBINET ABLUTION": 38,
  "ROBINET DOUBLE SERVICE": 41,
  "ROBINET JARDIN": 42,

  "FLEXIBLE ET DOUCHETTE": 45,
  "BONDE POUSSOIRE": 46,
  "VANNES SPHÉRIQUE": 47,
  "FLOTTEUR": 49,
  "CLAPET ANTI-RETOUR": 50,
  "ROBINET ARRÊT DE GAZ": 51,
  "FLEXIBLE DE GAZ": 52,

  "PIÈCES À SERTIR": 53,
  "PIÈCES À VISSER": 58,
  "COLLECTEURS": 63,
  "JEUX DE ROBINET": 65
];

categories.forEach((cat) => {
  const li = document.createElement("li");
  li.textContent = cat.name;
  li.onclick = () => renderPage(cat.page);
  categoryList.appendChild(li);
});
</script>


</body>
</html>
